@{
    ViewBag.Title = "Index";
}

<h2>Voorraad</h2>
<div class="form-group">
    <label for="Location_Id">locatie</label>
    <div class="col-md-10">
        @Html.DropDownList("Location_Id", null, htmlAttributes: new { @class = "form-control" })
    </div>
</div>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">
    var chart;
    google.load("visualization", "1", {packages:["corechart"]});
    google.setOnLoadCallback(drawChart);

    var DataAlleLocaties = @{Html.RenderAction("GetTotaleVoorraad");
    this.Response.ContentType = "text/html";
    // contentype moet weer worden veranderd naar een normale html pagina
    };
    var rawData = DataAlleLocaties;

    function drawChart() {
        var prepare = [];//['Year', 'Voorraad']
        for (item in rawData)
        {
            prepare.push([new Date(rawData[item].date), rawData[item].totaalTijdschriften]);
        }


        var data = new google.visualization.DataTable();
        data.addColumn('date', 'Date');
        data.addColumn('number', 'voorraad');
        data.addRows(prepare);

        var options = {
            title: 'Vooraad'
        };

        chart = new google.visualization.LineChart(document.getElementById('chart_div'));

        chart.draw(data, options);
    }

    $(document).ready(function(){
        $('#Location_Id').change(function() {
            var value = $('#Location_Id').val();
            if(value == '-1')
            {
                chart.clearChart();
                rawData = DataAlleLocaties;
                drawChart();
            }
            else
            {
                $.getJSON("@Url.Action("GetTotaleVooraadPerLocation")/"+value, function(data) {
                    chart.clearChart();
                    rawData = data;
                    drawChart();
                } );
            }
        });
    });

</script>

<div id="chart_div" style="width: 900px; height: 500px;"></div>
